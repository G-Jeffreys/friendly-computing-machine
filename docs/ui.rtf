{\rtf1\ansi\ansicpg1252\cocoartf2822
\cocoatextscaling0\cocoaplatform0{\fonttbl\f0\froman\fcharset0 Times-Roman;\f1\froman\fcharset0 Times-Bold;\f2\fmodern\fcharset0 Courier;
}
{\colortbl;\red255\green255\blue255;\red0\green0\blue0;\red109\green109\blue109;}
{\*\expandedcolortbl;;\cssrgb\c0\c0\c0;\cssrgb\c50196\c50196\c50196;}
{\*\listtable{\list\listtemplateid1\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid1}
{\list\listtemplateid2\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid101\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid2}
{\list\listtemplateid3\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid201\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid3}
{\list\listtemplateid4\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid301\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid302\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid4}
{\list\listtemplateid5\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid401\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{circle\}}{\leveltext\leveltemplateid402\'01\uc0\u9702 ;}{\levelnumbers;}\fi-360\li1440\lin1440 }{\listname ;}\listid5}
{\list\listtemplateid6\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid501\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid6}
{\list\listtemplateid7\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid601\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid7}
{\list\listtemplateid8\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid701\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid8}
{\list\listtemplateid9\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid801\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid9}
{\list\listtemplateid10\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid901\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid10}
{\list\listtemplateid11\listhybrid{\listlevel\levelnfc23\levelnfcn23\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{disc\}}{\leveltext\leveltemplateid1001\'01\uc0\u8226 ;}{\levelnumbers;}\fi-360\li720\lin720 }{\listname ;}\listid11}
{\list\listtemplateid12\listhybrid{\listlevel\levelnfc0\levelnfcn0\leveljc0\leveljcn0\levelfollow0\levelstartat1\levelspace360\levelindent0{\*\levelmarker \{decimal\}}{\leveltext\leveltemplateid1101\'01\'00;}{\levelnumbers\'01;}\fi-360\li720\lin720 }{\listname ;}\listid12}}
{\*\listoverridetable{\listoverride\listid1\listoverridecount0\ls1}{\listoverride\listid2\listoverridecount0\ls2}{\listoverride\listid3\listoverridecount0\ls3}{\listoverride\listid4\listoverridecount0\ls4}{\listoverride\listid5\listoverridecount0\ls5}{\listoverride\listid6\listoverridecount0\ls6}{\listoverride\listid7\listoverridecount0\ls7}{\listoverride\listid8\listoverridecount0\ls8}{\listoverride\listid9\listoverridecount0\ls9}{\listoverride\listid10\listoverridecount0\ls10}{\listoverride\listid11\listoverridecount0\ls11}{\listoverride\listid12\listoverridecount0\ls12}}
\margl1440\margr1440\vieww37900\viewh21300\viewkind0
\deftab720
\pard\pardeftab720\sa240\partightenfactor0

\f0\fs24 \cf0 \expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Absolutely \'97 here is the entire PRD output in 
\f1\b Markdown format
\f0\b0 . You can copy and paste it directly into a 
\f2\fs26 .md
\f0\fs24  file like 
\f2\fs26 grammarly-clone-upgrade-prd.md
\f0\fs24 :\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\partightenfactor0

\f2\fs26 \cf0 \strokec2 # \uc0\u55358 \u56800  Grammarly Clone UI & Feature Upgrade \'97 PRD\
\
## \uc0\u9989  Overview\
\
We are implementing:\
- A modernized UI with formatting tools\
- A 100-word \'93demo\'94 usage blocker for anonymous users\
- Autosave every 30s\
- A more robust editor\
- Faster document load experience\
\
---\
\
## 1. \uc0\u10024  Modern UI Refresh\
\
**Goal**: Improve the overall look and responsiveness of the app using `shadcn-ui` + Tailwind.\
\
### Tasks\
\
#### 1.1 Refactor Layout and Navigation\
- Update `/app/(dashboard)/layout.tsx` (or equivalent layout) to include:\
  - A sticky top navigation bar using `components/ui/navbar.tsx`\
  - Move document navigation to a sidebar (collapsible if needed)\
  - Add Tailwind breakpoints for responsive behavior\
\
#### 1.2 Global Styling\
- Update `globals.css`:\
  - Use `font-sans` and ensure a clean base typography\
  - Ensure dark/light mode support via Tailwind's `class` strategy\
\
#### 1.3 Component Polish\
- Refactor any custom buttons/inputs to use `shadcn/ui` equivalents (`<Button>`, `<Input>`, etc.)\
\
---\
\
## 2. \uc0\u55358 \u56810  Demo-Only Mode for Anonymous Users\
\
**Goal**: Allow unsigned users to edit up to 100 words for 10s before blocking them.\
\
### Tasks\
\
#### 2.1 Track Anonymous Usage\
- In `DocumentEditor.tsx`, count words in the editor (`editorText.split(/\\\\s+/).length`)\
- Use `useEffect` to start a `setTimeout()` 10 seconds after crossing 100 words\
\
#### 2.2 Popup Blocker\
- Create a `components/ui/OverlayModal.tsx` using `Dialog` from `@/components/ui/dialog`\
- On trigger, render a fullscreen modal:\
  - Text: \'93Sign up to keep writing\'94\
  - Buttons: \'93Sign up with Clerk\'94 or \'93Sign in\'94\
\
#### 2.3 Auth Check\
- Use `useAuth()` from Clerk in `DocumentEditor.tsx` to check for signed-in status\
- Skip limit if the user is authenticated\
\
---\
\
## 3. \uc0\u55357 \u56580  Autosave Every 30 Seconds\
\
**Goal**: Save draft updates every 30s without lag or excess DB hits.\
\
### Tasks\
\
#### 3.1 Add Autosave Hook\
- Create `lib/hooks/useAutosave.ts`\
```ts\
export function useAutosave(callback: () => void, delay: number) \{\
  useEffect(() => \{\
    const id = setInterval(callback, delay);\
    return () => clearInterval(id);\
  \}, [callback, delay]);\
\}\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b\fs24 \cf0 3.2 Use in Editor\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls1\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 In 
\f2\fs26 DocumentEditor.tsx
\f0\fs24 , call 
\f2\fs26 useAutosave(() => saveDocument(editorText), 30000)
\f0\fs24 \
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls1\ilvl0
\f2\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 saveDocument()
\f0\fs24  should call the 
\f2\fs26 PATCH
\f0\fs24  API route:\
\pard\pardeftab720\partightenfactor0

\f2\fs26 \cf0 await fetch(`/api/documents/$\{documentId\}`, \{\
  method: 'PATCH',\
  body: JSON.stringify(\{ content \}),\
\});\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b\fs24 \cf0 3.3 Debounce for Stability\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls2\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Use 
\f2\fs26 lodash.debounce()
\f0\fs24  to avoid firing PATCH while user is actively typing\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f1\b\fs36 \cf0 \strokec2 4. \uc0\u55357 \u56541  Rich Text Formatting Toolbar\
\pard\pardeftab720\sa240\partightenfactor0

\fs24 \cf0 Goal
\f0\b0 : Add formatting controls and persist them.\
\pard\pardeftab720\sa280\partightenfactor0

\f1\b\fs28 \cf0 Tasks\
\pard\pardeftab720\sa319\partightenfactor0

\fs24 \cf0 4.1 Change Storage Format\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls3\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 In 
\f2\fs26 documents
\f0\fs24  schema, change 
\f2\fs26 content
\f0\fs24  to support HTML (or markdown)\
\ls3\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Migrate existing text to simple 
\f2\fs26 <p>
\f0\fs24 -wrapped blocks (optional)\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b \cf0 4.2 Add Toolbar Component\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls4\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Create 
\f2\fs26 components/EditorToolbar.tsx
\f0\fs24 :\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls4\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Bold, Italics, Underline, Font Size, Text Align\
\ls4\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Buttons modify the current selection using 
\f2\fs26 document.execCommand()
\f0\fs24  or custom handlers\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b \cf0 4.3 Apply Formatting\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls5\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Update 
\f2\fs26 DocumentEditor.tsx
\f0\fs24 :\
\pard\tx940\tx1440\pardeftab720\li1440\fi-1440\sa240\partightenfactor0
\ls5\ilvl1\cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Change the 
\f2\fs26 textarea
\f0\fs24  to a 
\f2\fs26 contenteditable
\f0\fs24  
\f2\fs26 div
\f0\fs24 \
\ls5\ilvl1\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u9702 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Use 
\f2\fs26 innerHTML
\f0\fs24  binding for content\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b \cf0 4.4 Persist Formatting\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls6\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 On save (manual or autosave), extract 
\f2\fs26 .innerHTML
\f0\fs24  and send to Supabase\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f1\b\fs36 \cf0 \strokec2 5. \uc0\u55357 \u56960  Document Load Performance\
\pard\pardeftab720\sa240\partightenfactor0

\fs24 \cf0 Goal
\f0\b0 : Reduce time-to-edit when opening a doc.\
\pard\pardeftab720\sa280\partightenfactor0

\f1\b\fs28 \cf0 Tasks\
\pard\pardeftab720\sa319\partightenfactor0

\fs24 \cf0 5.1 Preload Text via Server Props\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls7\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 In 
\f2\fs26 /app/documents/[documentId]/page.tsx
\f0\fs24 , fetch the document server-side and pass down as prop\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b \cf0 5.2 Skeleton Loader\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls8\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Add 
\f2\fs26 components/ui/DocumentSkeleton.tsx
\f0\fs24  to show gray bars while loading\
\pard\pardeftab720\sa319\partightenfactor0

\f1\b \cf0 5.3 Defer Non-Critical JS\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls9\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Defer analytics, heavy LLM calls, and editor overlays using 
\f2\fs26 React.lazy()
\f0\fs24  + 
\f2\fs26 Suspense
\f0\fs24 \
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f1\b\fs36 \cf0 \strokec2 6. \uc0\u55358 \u56809  Optional: Modular Editor Refactor\
\pard\pardeftab720\sa240\partightenfactor0

\fs24 \cf0 Goal
\f0\b0 : Organize 
\f2\fs26 DocumentEditor.tsx
\f0\fs24  into smaller, cleaner files.\
\pard\pardeftab720\sa280\partightenfactor0

\f1\b\fs28 \cf0 Tasks\
\pard\pardeftab720\sa319\partightenfactor0

\fs24 \cf0 6.1 Split into Modules\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls10\ilvl0
\f2\b0\fs26 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 /components/editor/EditorContainer.tsx
\f0\fs24 \
\ls10\ilvl0
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 /components/editor/EditorTextLayer.tsx
\f0\fs24 \
\ls10\ilvl0
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 /components/editor/EditorOverlay.tsx
\f0\fs24 \
\ls10\ilvl0
\f2\fs26 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 /components/editor/EditorToolbar.tsx
\f0\fs24 \
\pard\pardeftab720\sa319\partightenfactor0

\f1\b \cf0 6.2 Use Context\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls11\ilvl0
\f0\b0 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	\uc0\u8226 	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Share state like content, formatting, documentId via React context\
\pard\pardeftab720\partightenfactor0
\cf3 \strokec3 \
\pard\pardeftab720\sa298\partightenfactor0

\f1\b\fs36 \cf0 \strokec2 \uc0\u9989  MVP Completion Criteria\
\pard\tx220\tx720\pardeftab720\li720\fi-720\sa240\partightenfactor0
\ls12\ilvl0
\f0\b0\fs24 \cf0 \kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	1	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Clean layout with navbar and styled components\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	2	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Auth-free users blocked after 100 words + 10s\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	3	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Autosave works reliably every 30s (debounced)\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	4	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Text formatting toolbar is available and persisted\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	5	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Document load time is snappy, with skeleton shown if delayed\
\ls12\ilvl0\kerning1\expnd0\expndtw0 \outl0\strokewidth0 {\listtext	6	}\expnd0\expndtw0\kerning0
\outl0\strokewidth0 \strokec2 Code is modular and uses best practices (context, hooks)
\f2\fs26 \
\pard\pardeftab720\partightenfactor0
\cf0 ---\
\
Let me know if you'd like a matching `.csv` task list or Notion importable structure next.\
}